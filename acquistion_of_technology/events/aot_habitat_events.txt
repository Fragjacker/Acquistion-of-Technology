namespace = aot_habitat_events

# Deactivate support pylon on building demolish
planet_event = {
	id = aot_habitat_events.1
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		deactivate_all_planet_support_pylons = yes
	}
}

# Update the last built minor or major orbital if we have a delta tier complex or higher in the system.
country_event = {
	id = aot_habitat_events.2
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		from.planet = {
			save_event_target_as = target_planet
		}
		fromfrom.solar_system = {
			random_system_planet = {
				limit = {
					has_planet_flag = habitat
				}
				save_event_target_as = central_habitat
			}
		}
		if = {
			limit = {
				exists = event_target:central_habitat
			}
			event_target:central_habitat = {
				switch = {
					trigger = is_planet_class
					pc_dm_habitat = {
						update_last_orbital_wrapper = {
							TIER = dm
						}
					}
					pc_ae_habitat = {
						update_last_orbital_wrapper = {
							TIER = ae
						}
					}
					pc_phanon_habitat = {
						update_last_orbital_wrapper = {
							TIER = phanon
						}
					}
					pc_sigma_habitat = {
						update_last_orbital_wrapper = {
							TIER = sigma
						}
					}
					pc_sigma_deepspace_habitat = {
						update_last_orbital_wrapper = {
							TIER = sigma
						}
					}
				}
			}
		}
	}
}