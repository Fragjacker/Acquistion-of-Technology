namespace = aot_planetary_shields_event
#---------------------------------------
# This handles the creation of shield
# Ambient objects on planets.
#---------------------------------------

# Check if we need to spawn the planetary shield bubble graphic.
# This = Planet
planet_event = {
	id = aot_planetary_shields_event.1
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		NOT = {
			has_global_flag = aot_planetary_shields_OFF
		}
	}
	immediate = {
		refresh_planetary_shields = yes
	}
}

# Refresh planetary shields for every galaxy system.
# This = Planet
event = {
	id = aot_planetary_shields_event.2
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		NOT = {
			has_global_flag = aot_planetary_shields_OFF
		}
	}
	immediate = {
		every_system = {
			refresh_planetary_shields = yes
		}
	}
}

# Delete all planetary shields via ACOT menu edict decision.
# This = Planet
country_event = {
	id = aot_planetary_shields_event.3
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		every_galaxy_planet = {
			remove_planet_flag = has_ae_planetary_shield_01
			remove_planet_flag = has_dm_planetary_shield_01
			remove_planet_flag = has_stellarite_planetary_shield_01
			remove_planet_flag = has_phanon_planetary_shield_01
			solar_system = {
				every_system_ambient_object = {
					limit = {
						is_aot_planetary_shield_ambient_object = yes
					}
					destroy_ambient_object = this
				}
			}
		}
	}
}