# ------------------------------------------------------------------------------------------------ #
#                      AoT special habitat values for the support pylon system                     #
# ------------------------------------------------------------------------------------------------ #
aot_count_system_active_support_pylons = {
	complex_trigger_modifier = {
		trigger = count_system_megastructure
		trigger_scope = solar_system
		parameters = {
			limit = {
				is_active_support_pylon = yes
			}
		}
		mode = add
	}
}
# ---------------- Calculate the desired production bonus per built support pylon. --------------- #
aot_get_system_support_pylon_bonus = {
	add = value:aot_count_system_active_support_pylons
	mult = 0.1 # 10% bonus per support pylon.
	add = 1 # We need to add 1 since this is positive multiplier e.g. 1.1 x production values.
}
# --------------- Calculate the amount of bonus workforce multiplier for the planet -------------- #
aot_conduit_planet_job_bonus = {
	base = 2
	pow = $EXPONENT$
	mult = 0.01 # 1% bonus per tier.
	mult = value:aot_count_system_active_support_pylons # Multiplied per active support pylon.
}
aot_scripted_loc_conduit_planet_job_bonus = {
	add = value:aot_conduit_planet_job_bonus|EXPONENT|$EXPONENT$|
	mult = 100 # 1% bonus per tier.
}
# ----------- Gets the amount of currently built mining districts, no matter the tier. ----------- #
aot_get_num_built_mining_districts = {
	complex_trigger_modifier = {
		trigger = num_districts
		parameters = {
			type = district_dm_hab_mining
		}
		mode = add
	}
	complex_trigger_modifier = {
		trigger = num_districts
		parameters = {
			type = district_ae_hab_mining
		}
		mode = add
	}
	complex_trigger_modifier = {
		trigger = num_districts
		parameters = {
			type = district_hab_phanon_mining
		}
		mode = add
	}
	complex_trigger_modifier = {
		trigger = num_districts
		parameters = {
			type = district_hab_stellarite_mining
		}
		mode = add
	}
}
# ----------- Gets the amount of currently built energy districts, no matter the tier. ----------- #
aot_get_num_built_energy_districts = {
	complex_trigger_modifier = {
		trigger = num_districts
		parameters = {
			type = district_dm_hab_energy
		}
		mode = add
	}
	complex_trigger_modifier = {
		trigger = num_districts
		parameters = {
			type = district_ae_hab_energy
		}
		mode = add
	}
	complex_trigger_modifier = {
		trigger = num_districts
		parameters = {
			type = district_hab_phanon_energy
		}
		mode = add
	}
	complex_trigger_modifier = {
		trigger = num_districts
		parameters = {
			type = district_hab_stellarite_energy
		}
		mode = add
	}
}
# ------------------ Count the amount of regular celestial bodies in the system. ----------------- #
aot_count_system_planets = {
	complex_trigger_modifier = {
		trigger = count_system_planet
		trigger_scope = solar_system
		parameters = {
			limit = {
				is_artificial = no
				is_astral_scar = no
			}
		}
		mode = add
	}
}
# ------------ Calculate the maximum amount of mineral/energy deposits in the system. ------------ #
aot_count_system_deposits = {
	complex_trigger_modifier = {
		trigger = count_system_planet
		trigger_scope = solar_system
		parameters = {
			limit = {
				is_artificial = no
				is_astral_scar = no
				has_deposit = d_$TYPE$_1
			}
		}
		mode = add
	}
	complex_trigger_modifier = {
		trigger = count_system_planet
		trigger_scope = solar_system
		parameters = {
			limit = {
				is_artificial = no
				is_astral_scar = no
				OR = {
					has_deposit = d_$TYPE$_2
					has_deposit = d_$TYPE$_3
				}
			}
		}
		mode = add
		mult = 2
	}
	complex_trigger_modifier = {
		trigger = count_system_planet
		trigger_scope = solar_system
		parameters = {
			limit = {
				is_artificial = no
				is_astral_scar = no
				OR = {
					has_deposit = d_$TYPE$_4
					has_deposit = d_$TYPE$_5
				}
			}
		}
		mode = add
		mult = 3
	}
	complex_trigger_modifier = {
		trigger = count_system_planet
		trigger_scope = solar_system
		parameters = {
			limit = {
				is_artificial = no
				is_astral_scar = no
				OR = {
					has_deposit = d_$TYPE$_6
					has_deposit = d_$TYPE$_7
				}
			}
		}
		mode = add
		mult = 4
	}
	complex_trigger_modifier = {
		trigger = count_system_planet
		trigger_scope = solar_system
		parameters = {
			limit = {
				is_artificial = no
				is_astral_scar = no
				OR = {
					has_deposit = d_$TYPE$_8
					has_deposit = d_$TYPE$_9
				}
			}
		}
		mode = add
		mult = 5
	}
	complex_trigger_modifier = {
		trigger = count_system_planet
		trigger_scope = solar_system
		parameters = {
			limit = {
				is_artificial = no
				is_astral_scar = no
				has_deposit = d_$TYPE$_10
			}
		}
		mode = add
		mult = 6
	}
}
# -------------------- Base amount PLUS amount of districts added by conduits -------------------- #
aot_special_resource_habitat_districts_target_amount = {
	add = value:aot_count_system_conduit_buildings
	add = @size_lvl1
}
# --------------------- Count the amount of conduit buildings in the system. --------------------- #
aot_count_system_conduit_buildings = {
	complex_trigger_modifier = {
		trigger = count_system_colony
		trigger_scope = solar_system
		parameters = {
			limit = {
				is_aot_habitat = no # Don't count conduits built on the habitat itself.
				has_conduit_building = yes
			}
		}
		mode = add
		mult = @num_support_pylons # The amount of desired support pylons per conduit which are spawned.
	}
}
# -------------------- Count the amount of habitat special resource districts. ------------------- #
aot_count_special_resource_habitat_districts = {
	complex_trigger_modifier = {
		trigger = num_districts
		parameters = {
			type = district_dm_hab_dark_matter_energy
		}
		mode = add
	}
	complex_trigger_modifier = {
		trigger = num_districts
		parameters = {
			type = district_ae_hab_dark_matter_energy
		}
		mode = add
	}
	complex_trigger_modifier = {
		trigger = num_districts
		parameters = {
			type = district_hab_phanon_generator
		}
		mode = add
	}
	complex_trigger_modifier = {
		trigger = num_districts
		parameters = {
			type = district_hab_stellarite_generator
		}
		mode = add
	}
}
# --------------- Amount special resource districts MINUS calculated target amount. -------------- #
aot_get_habitat_special_district_difference = {
	add = value:aot_count_special_resource_habitat_districts
	subtract = value:aot_special_resource_habitat_districts_target_amount
}
# ------ Amount special resource districts MINUS amount of currently active support pylons. ------ #
aot_get_difference_amount_support_pylons_against_special_habitat_distrcits = {
	add = value:aot_count_system_active_support_pylons
	subtract = value:aot_special_resource_habitat_districts_target_amount
}